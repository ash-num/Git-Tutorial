This is the utility function of version three...